/*
 * RSA_dec.c
 *
 *  Created on: 31 juil. 2023
 *      Author: loict
 */
#include "RSA_dec.h"
int* ro_data;
#ifdef INPUT_RAM2
__attribute__((section (".ram2data")))
#endif
int c[SIZE] = {33,19,59,123,101,73,59,19,75,59,202,19,142,59,142,19,59,123,101,73,59,142,26,7,
            142,59,79,106,59,142,26,101,59,139,195,101,106,142,79,19,202,46,59,9,26,101,142,
            26,101,75,59,142,79,106,59,202,19,123,82,101,75,59,79,202,59,142,26,101,59,216,79,
            202,178,59,142,19,59,106,195,119,119,101,75,59,33,26,101,59,106,82,79,202,103,106,59,
            7,202,178,59,7,33,19,59,123,101,73,59,19,75,59,202,19,142,59,142,19,59,123,101,73,59,142,26,
            7,142,59,79,106,59,142,26,101,59,139,195,101,106,142,79,19,202,46,59,9,26,101,142,26,101,75,
            59,142,79,106,59,202,19,123,82,101,75,59,79,202,59,142,26,101,59,216,79,202,178,59,142,19,59,
            106,195,119,119,101,75,59,33,26,101,59,106,82,79,202,103,106,59,7,202,178,59,7,33,19,59,123,101,
            73,59,19,75,59,202,19,142,59,142,19,59,123,101,73,59,142,26,7,142,59,79,106,59,142,26,101,59,139,
            195,101,106,142,79,19,202,46,59,9,26,101,142,26,101,75,59,142,79,106,59,202,19,123,82,101,75,59,
            79,202,59,142,26,101,59,216,79,202,178,59,142,19,59,106,195,119,119,101,75,59,33,26,101,59,106,
            82,79,202,103,106,59,7,202,178,59,7,33,19,59,123,101,73,59,19,75,59,202,19,142,59,142,19,59,123,
            101,73,59,142,26,7,142,59,79,106,59,142,26,101,59,139,195,101,106,142,79,19,202,46,59,9,26,101,
            142,26,101,75,59,142,79,106,59,202,19,123,82,101,75,59,79,202,59,142,26,101,59,216,79,202,
            178,59,142,19,59,106,195,119,119,101,75,59,33,26,101,59,106,82,79,202,103,106,59,7,202,178,
            59,7,33,19,59,123,101,73,59,19,75,59,202,19,142,59,142,19,59,123,101,73,59,142,26,7,142,59,
            79,106,59,142,26,101,59,139,195,101,106,142,79,19,202,46,59,9,26,101,142,26,101,75,59,142,
            79,106,59,202,19,123,82,101,75,59,79,202,59,142,26,101,59,216,79,202,178,59,142,19,59,106,
            195,119,119,101,75,59,33,26,101,59,106,82,79,202,103,106,59,7,202,178,59,7};
int ro_data_src[3] = {7, 221, 55};
char de_plaintext_char[SIZE];

void decrypt(){
  ro_data = ro_data_src;
  int temp_var=1;

  for(int i=0;i<SIZE;i++){
     for(int j=0; j< ro_data[2]; j++){
    temp_var=temp_var*c[i] % ro_data[1];
     }
     de_plaintext_char[i]=temp_var;
     temp_var=1;
  }
}

void decrypt_ccm(){
  ro_data = ro_data_src;
  int temp_var=1;

  for(int i=0;i<SIZE;i++){
     for(int j=0; j< ro_data[2]; j++){
    temp_var=temp_var*c[i] % ro_data[1];
     }
     de_plaintext_char[i]=temp_var;
     temp_var=1;
  }
}

void decrypt_ram(){
  ro_data = ro_data_src;
  int temp_var=1;

  for(int i=0;i<SIZE;i++){
     for(int j=0; j< ro_data[2]; j++){
    temp_var=temp_var*c[i] % ro_data[1];
     }
     de_plaintext_char[i]=temp_var;
     temp_var=1;
  }
}

void decrypt_ram2(){
  ro_data = ro_data_src;
  int temp_var=1;

  for(int i=0;i<SIZE;i++){
     for(int j=0; j< ro_data[2]; j++){
    temp_var=temp_var*c[i] % ro_data[1];
     }
     de_plaintext_char[i]=temp_var;
     temp_var=1;
  }
}
